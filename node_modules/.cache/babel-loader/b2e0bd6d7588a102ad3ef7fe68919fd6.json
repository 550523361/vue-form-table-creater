{"remainingRequest":"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/babel-loader/lib/index.js!/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/src/components/formCreater/addImages.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/src/components/formCreater/addImages.vue","mtime":1553238283618},{"path":"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.map\";\nimport _Promise from \"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport _JSON$stringify from \"/Users/iriskang/xkfeng/formAndTableCreater/vue-form-table-creater/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport draggable from 'vuedraggable';\nexport default {\n  components: {\n    draggable: draggable\n  },\n  name: 'images',\n  data: function data() {\n    return {\n      drag: false,\n      showItemId: 0,\n      config: {\n        readonly: false\n      },\n      orderableImageList: []\n    };\n  },\n  methods: {\n    addItem: function addItem(frame, seq, url) {\n      console.log(frame.length);\n\n      if (frame.length >= this.config.maxNum) {\n        return;\n      }\n\n      frame.push({\n        id: url,\n        name: '图片',\n        url: url || ''\n      });\n      this.$set(this, \"orderableImageList\", JSON.parse(_JSON$stringify(this.orderableImageList)));\n      this.syncData();\n    },\n    moveItem: function moveItem(event, frame, index, item, seq, direction, moveType) {\n      event.preventDefault();\n      event.stopPropagation();\n      console.log(frame, index, item, seq, direction, moveType);\n\n      if (direction == \"v\") {\n        var tempItem = frame.splice(seq, 1)[0];\n        frame.splice(seq + moveType, 0, tempItem);\n      } else if (direction == \"h\") {\n        var targetFram = this.orderableImageList[index + moveType];\n        var _tempItem = frame.splice(seq, 1)[0];\n        targetFram.push(_tempItem);\n      } else if (direction == \"d\") {\n        frame.splice(seq, 1);\n\n        if (frame.length == 0 && this.orderableImageList.length > 5) {\n          this.orderableImageList.splice(index, 1);\n        }\n      }\n\n      this.$set(this, \"orderableImageList\", JSON.parse(_JSON$stringify(this.orderableImageList)));\n      this.syncData();\n    },\n    draggItemFun: function draggItemFun(param) {\n      this.drag = false;\n      this.syncData();\n    },\n    mouseout: function mouseout(item) {\n      this.showItemId = 0;\n    },\n    mouseover: function mouseover(item) {\n      this.showItemId = item.id;\n    },\n    saveAppSuccess: function saveAppSuccess(response, file, fileList) {\n      var _this = this;\n\n      // console.log(response,file,fileList)\n      console.log(file);\n      var url = response.data.fileUrls[0];\n      this.addItem(this.orderableImageList, 0, url);\n      this.$nextTick(function (data) {\n        _this.loading && _this.loading.close && _this.loading.close();\n      });\n    },\n    onchangeUpload: function onchangeUpload(data) {\n      this.choosedAppIcon = data;\n    },\n    beforeIconUpload: function beforeIconUpload(file) {\n      //console.log(\"beforeIconUpload\",file)\n      var that = this;\n      return new _Promise(function (resolve, reject) {\n        if (!(file.type == \"image/png\" || file.type == \"image/jpg\" || file.type == \"image/jpeg\" || file.type == \"image/gif\")) {\n          that.$message.error('请选择.png/jpg/jpeg图片');\n          reject({\n            msg: \"please choose png image\"\n          });\n        }\n\n        if (that.choosedAppIcon != null) {\n          var reader = new FileReader();\n\n          reader.onload = function (event) {\n            var image = new Image();\n\n            image.onload = function (data) {\n              //console.log(\"*******\",data,file)\n              var imageData = data.path && data.path[0] || data.target;\n              var imageWidth = imageData.width,\n                  imageHeight = imageData.height;\n\n              if (that.config.imageConfig) {\n                var imageConfig = that.config.imageConfig;\n\n                if (imageConfig.size) {\n                  if (file.size > imageConfig.size) {\n                    that.$msgbox(\"上传图片过大 请不要超过 \" + (imageConfig.size / 1024 / 1024).toFixed(2) + \" Mb\");\n                    reject({\n                      msg: \"上传图片过大 请不要超过 \" + imageConfig.size / 1024 / 1024 + \" Mb\"\n                    });\n                    return;\n                  }\n                }\n\n                if (imageConfig.width) {\n                  if (imageWidth != imageConfig.width) {\n                    console.log(imageWidth, imageHeight);\n                    that.$msgbox(\"图片宽度必须为\" + imageConfig.width + \"px\");\n                    reject({\n                      msg: \"图片宽度必须为\" + imageConfig.width + \"px\"\n                    });\n                    return;\n                  }\n                }\n\n                if (imageConfig.height) {\n                  if (imageHeight != imageConfig.height) {\n                    that.$msgbox(\"图片高度必须为\" + imageConfig.height + \"px\");\n                    reject({\n                      msg: \"图片高度必须为\" + imageConfig.height + \"px\"\n                    });\n                    return;\n                  }\n                }\n\n                that.loading = that.$loading({\n                  lock: true,\n                  text: 'Loading',\n                  spinner: 'el-icon-loading',\n                  background: 'rgba(0, 0, 0, 0.3)'\n                });\n                resolve({\n                  msg: \"success\"\n                });\n              } else {\n                if (that.config.validatorHandler && typeof that.config.validatorHandler == \"function\") {\n                  var result = that.config.validatorHandler(imageWidth, imageHeight, file);\n\n                  if (result instanceof _Promise) {\n                    result.then(function (success) {\n                      that.loading = that.$loading({\n                        lock: true,\n                        text: 'Loading',\n                        spinner: 'el-icon-loading',\n                        background: 'rgba(0, 0, 0, 0.3)'\n                      });\n                      resolve({\n                        msg: \"success\"\n                      });\n                    }, function (error) {\n                      that.$msgbox(error.msg);\n                      reject({\n                        msg: error.msg\n                      });\n                    });\n                  } else {\n                    if (result) {\n                      that.$msgbox(result.msg);\n                      reject({\n                        msg: result.msg\n                      });\n                    } else {\n                      that.loading = that.$loading({\n                        lock: true,\n                        text: 'Loading',\n                        spinner: 'el-icon-loading',\n                        background: 'rgba(0, 0, 0, 0.3)'\n                      });\n                      resolve({\n                        msg: \"success\"\n                      });\n                    }\n                  }\n                } else {\n                  that.loading = that.$loading({\n                    lock: true,\n                    text: 'Loading',\n                    spinner: 'el-icon-loading',\n                    background: 'rgba(0, 0, 0, 0.3)'\n                  });\n                  resolve({\n                    msg: \"success\"\n                  });\n                }\n              }\n            };\n\n            image.src = event.target.result;\n          };\n\n          reader.readAsDataURL(file);\n        }\n      });\n    },\n    syncData: function syncData() {\n      if (this.config.dataBus) {\n        if (typeof this.config.dataBus === \"function\") {\n          this.$attrs.config.data = this.orderableImageList.map(function (item) {\n            return item.url;\n          });\n          this.config.dataBus(this.config, this.orderableImageList.map(function (item) {\n            return item.url;\n          }));\n        }\n      }\n    },\n    init: function init() {\n      var config = this.$attrs.config;\n      this.config = config.imagesListConfig;\n      var formData = config.data;\n\n      if (formData) {\n        var orderableImageList = JSON.parse(_JSON$stringify(formData)); //console.log(\"orderableI--------mageList\",orderableImageList)\n\n        orderableImageList = orderableImageList.map(function (item) {\n          return {\n            url: item,\n            id: 'file_Id_temp' + Math.ceil(Math.random() * 1000),\n            name: 'file_temp' + Math.ceil(Math.random() * 1000)\n          };\n        });\n        this.orderableImageList = orderableImageList;\n        this.$set(this, \"orderableImageList\", JSON.parse(_JSON$stringify(this.orderableImageList)));\n\n        if (this.config.dataBus) {\n          if (typeof this.config.dataBus === \"function\") {\n            this.syncData(\"init\");\n          }\n        }\n      }\n    }\n  },\n  created: function created() {},\n  computed: {},\n  mounted: function mounted() {\n    this.$watch(\"$attrs.config\", function (newData, oldData) {\n      //console.log(\"newData,oldData\",newData)\n      this.init();\n    }, {\n      deep: true\n    });\n    this.init();\n  }\n};",{"version":3,"sources":["addImages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA,OAAA,SAAA,MAAA,cAAA;AAEA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA;AADA,GADA;AAIA,EAAA,IAAA,EAAA,QAJA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,UAAA,EAAA,CAFA;AAGA,MAAA,MAAA,EAAA;AACA,QAAA,QAAA,EAAA;AADA,OAHA;AAMA,MAAA,kBAAA,EAAA;AANA,KAAA;AAQA,GAdA;AAeA,EAAA,OAAA,EAAA;AACA,IAAA,OADA,mBACA,KADA,EACA,GADA,EACA,GADA,EACA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA,MAAA;;AACA,UAAA,KAAA,CAAA,MAAA,IAAA,KAAA,MAAA,CAAA,MAAA,EAAA;AACA;AACA;;AACA,MAAA,KAAA,CAAA,IAAA,CAAA;AACA,QAAA,EAAA,EAAA,GADA;AAEA,QAAA,IAAA,EAAA,IAFA;AAGA,QAAA,GAAA,EAAA,GAAA,IAAA;AAHA,OAAA;AAKA,WAAA,IAAA,CAAA,IAAA,EAAA,oBAAA,EAAA,IAAA,CAAA,KAAA,CAAA,gBAAA,KAAA,kBAAA,CAAA,CAAA;AACA,WAAA,QAAA;AACA,KAbA;AAcA,IAAA,QAdA,oBAcA,KAdA,EAcA,KAdA,EAcA,KAdA,EAcA,IAdA,EAcA,GAdA,EAcA,SAdA,EAcA,QAdA,EAcA;AACA,MAAA,KAAA,CAAA,cAAA;AACA,MAAA,KAAA,CAAA,eAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,EAAA,KAAA,EAAA,IAAA,EAAA,GAAA,EAAA,SAAA,EAAA,QAAA;;AACA,UAAA,SAAA,IAAA,GAAA,EAAA;AACA,YAAA,QAAA,GAAA,KAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA,EAAA,CAAA,CAAA;AACA,QAAA,KAAA,CAAA,MAAA,CAAA,GAAA,GAAA,QAAA,EAAA,CAAA,EAAA,QAAA;AACA,OAHA,MAGA,IAAA,SAAA,IAAA,GAAA,EAAA;AACA,YAAA,UAAA,GAAA,KAAA,kBAAA,CAAA,KAAA,GAAA,QAAA,CAAA;AACA,YAAA,SAAA,GAAA,KAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA,EAAA,CAAA,CAAA;AACA,QAAA,UAAA,CAAA,IAAA,CAAA,SAAA;AACA,OAJA,MAIA,IAAA,SAAA,IAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA;;AACA,YAAA,KAAA,CAAA,MAAA,IAAA,CAAA,IAAA,KAAA,kBAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,eAAA,kBAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA;AACA;;AACA,WAAA,IAAA,CAAA,IAAA,EAAA,oBAAA,EAAA,IAAA,CAAA,KAAA,CAAA,gBAAA,KAAA,kBAAA,CAAA,CAAA;AACA,WAAA,QAAA;AACA,KAjCA;AAkCA,IAAA,YAlCA,wBAkCA,KAlCA,EAkCA;AACA,WAAA,IAAA,GAAA,KAAA;AACA,WAAA,QAAA;AACA,KArCA;AAsCA,IAAA,QAtCA,oBAsCA,IAtCA,EAsCA;AACA,WAAA,UAAA,GAAA,CAAA;AACA,KAxCA;AAyCA,IAAA,SAzCA,qBAyCA,IAzCA,EAyCA;AACA,WAAA,UAAA,GAAA,IAAA,CAAA,EAAA;AACA,KA3CA;AA4CA,IAAA,cA5CA,0BA4CA,QA5CA,EA4CA,IA5CA,EA4CA,QA5CA,EA4CA;AAAA;;AACA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,UAAA,GAAA,GAAA,QAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,CAAA;AACA,WAAA,OAAA,CAAA,KAAA,kBAAA,EAAA,CAAA,EAAA,GAAA;AACA,WAAA,SAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,KAAA,CAAA,OAAA,IAAA,KAAA,CAAA,OAAA,CAAA,KAAA,IAAA,KAAA,CAAA,OAAA,CAAA,KAAA,EAAA;AACA,OAFA;AAGA,KApDA;AAqDA,IAAA,cArDA,0BAqDA,IArDA,EAqDA;AACA,WAAA,cAAA,GAAA,IAAA;AACA,KAvDA;AAwDA,IAAA,gBAxDA,4BAwDA,IAxDA,EAwDA;AACA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,aAAA,aAAA,UAAA,OAAA,EAAA,MAAA,EAAA;AACA,YAAA,EAAA,IAAA,CAAA,IAAA,IAAA,WAAA,IAAA,IAAA,CAAA,IAAA,IAAA,WAAA,IAAA,IAAA,CAAA,IAAA,IAAA,YAAA,IAAA,IAAA,CAAA,IAAA,IAAA,WAAA,CAAA,EAAA;AACA,UAAA,IAAA,CAAA,QAAA,CAAA,KAAA,CAAA,oBAAA;AACA,UAAA,MAAA,CAAA;AAAA,YAAA,GAAA,EAAA;AAAA,WAAA,CAAA;AACA;;AACA,YAAA,IAAA,CAAA,cAAA,IAAA,IAAA,EAAA;AACA,cAAA,MAAA,GAAA,IAAA,UAAA,EAAA;;AACA,UAAA,MAAA,CAAA,MAAA,GAAA,UAAA,KAAA,EAAA;AACA,gBAAA,KAAA,GAAA,IAAA,KAAA,EAAA;;AACA,YAAA,KAAA,CAAA,MAAA,GAAA,UAAA,IAAA,EAAA;AACA;AACA,kBAAA,SAAA,GAAA,IAAA,CAAA,IAAA,IAAA,IAAA,CAAA,IAAA,CAAA,CAAA,CAAA,IAAA,IAAA,CAAA,MAAA;AACA,kBAAA,UAAA,GAAA,SAAA,CAAA,KAAA;AAAA,kBAAA,WAAA,GAAA,SAAA,CAAA,MAAA;;AACA,kBAAA,IAAA,CAAA,MAAA,CAAA,WAAA,EAAA;AACA,oBAAA,WAAA,GAAA,IAAA,CAAA,MAAA,CAAA,WAAA;;AACA,oBAAA,WAAA,CAAA,IAAA,EAAA;AACA,sBAAA,IAAA,CAAA,IAAA,GAAA,WAAA,CAAA,IAAA,EAAA;AACA,oBAAA,IAAA,CAAA,OAAA,CAAA,kBAAA,CAAA,WAAA,CAAA,IAAA,GAAA,IAAA,GAAA,IAAA,EAAA,OAAA,CAAA,CAAA,CAAA,GAAA,KAAA;AACA,oBAAA,MAAA,CAAA;AAAA,sBAAA,GAAA,EAAA,kBAAA,WAAA,CAAA,IAAA,GAAA,IAAA,GAAA,IAAA,GAAA;AAAA,qBAAA,CAAA;AACA;AACA;AACA;;AACA,oBAAA,WAAA,CAAA,KAAA,EAAA;AACA,sBAAA,UAAA,IAAA,WAAA,CAAA,KAAA,EAAA;AACA,oBAAA,OAAA,CAAA,GAAA,CAAA,UAAA,EAAA,WAAA;AACA,oBAAA,IAAA,CAAA,OAAA,CAAA,YAAA,WAAA,CAAA,KAAA,GAAA,IAAA;AACA,oBAAA,MAAA,CAAA;AAAA,sBAAA,GAAA,EAAA,YAAA,WAAA,CAAA,KAAA,GAAA;AAAA,qBAAA,CAAA;AACA;AACA;AAEA;;AACA,oBAAA,WAAA,CAAA,MAAA,EAAA;AACA,sBAAA,WAAA,IAAA,WAAA,CAAA,MAAA,EAAA;AACA,oBAAA,IAAA,CAAA,OAAA,CAAA,YAAA,WAAA,CAAA,MAAA,GAAA,IAAA;AACA,oBAAA,MAAA,CAAA;AAAA,sBAAA,GAAA,EAAA,YAAA,WAAA,CAAA,MAAA,GAAA;AAAA,qBAAA,CAAA;AACA;AACA;AACA;;AACA,gBAAA,IAAA,CAAA,OAAA,GAAA,IAAA,CAAA,QAAA,CAAA;AACA,kBAAA,IAAA,EAAA,IADA;AAEA,kBAAA,IAAA,EAAA,SAFA;AAGA,kBAAA,OAAA,EAAA,iBAHA;AAIA,kBAAA,UAAA,EAAA;AAJA,iBAAA,CAAA;AAMA,gBAAA,OAAA,CAAA;AAAA,kBAAA,GAAA,EAAA;AAAA,iBAAA,CAAA;AACA,eAhCA,MAgCA;AACA,oBAAA,IAAA,CAAA,MAAA,CAAA,gBAAA,IAAA,OAAA,IAAA,CAAA,MAAA,CAAA,gBAAA,IAAA,UAAA,EAAA;AACA,sBAAA,MAAA,GAAA,IAAA,CAAA,MAAA,CAAA,gBAAA,CAAA,UAAA,EAAA,WAAA,EAAA,IAAA,CAAA;;AACA,sBAAA,MAAA,oBAAA,EAAA;AACA,oBAAA,MAAA,CAAA,IAAA,CAAA,UAAA,OAAA,EAAA;AACA,sBAAA,IAAA,CAAA,OAAA,GAAA,IAAA,CAAA,QAAA,CAAA;AACA,wBAAA,IAAA,EAAA,IADA;AAEA,wBAAA,IAAA,EAAA,SAFA;AAGA,wBAAA,OAAA,EAAA,iBAHA;AAIA,wBAAA,UAAA,EAAA;AAJA,uBAAA,CAAA;AAMA,sBAAA,OAAA,CAAA;AAAA,wBAAA,GAAA,EAAA;AAAA,uBAAA,CAAA;AACA,qBARA,EAQA,UAAA,KAAA,EAAA;AACA,sBAAA,IAAA,CAAA,OAAA,CAAA,KAAA,CAAA,GAAA;AACA,sBAAA,MAAA,CAAA;AAAA,wBAAA,GAAA,EAAA,KAAA,CAAA;AAAA,uBAAA,CAAA;AACA,qBAXA;AAYA,mBAbA,MAaA;AACA,wBAAA,MAAA,EAAA;AACA,sBAAA,IAAA,CAAA,OAAA,CAAA,MAAA,CAAA,GAAA;AACA,sBAAA,MAAA,CAAA;AAAA,wBAAA,GAAA,EAAA,MAAA,CAAA;AAAA,uBAAA,CAAA;AACA,qBAHA,MAGA;AACA,sBAAA,IAAA,CAAA,OAAA,GAAA,IAAA,CAAA,QAAA,CAAA;AACA,wBAAA,IAAA,EAAA,IADA;AAEA,wBAAA,IAAA,EAAA,SAFA;AAGA,wBAAA,OAAA,EAAA,iBAHA;AAIA,wBAAA,UAAA,EAAA;AAJA,uBAAA,CAAA;AAMA,sBAAA,OAAA,CAAA;AAAA,wBAAA,GAAA,EAAA;AAAA,uBAAA,CAAA;AACA;AACA;AACA,iBA7BA,MA6BA;AACA,kBAAA,IAAA,CAAA,OAAA,GAAA,IAAA,CAAA,QAAA,CAAA;AACA,oBAAA,IAAA,EAAA,IADA;AAEA,oBAAA,IAAA,EAAA,SAFA;AAGA,oBAAA,OAAA,EAAA,iBAHA;AAIA,oBAAA,UAAA,EAAA;AAJA,mBAAA,CAAA;AAMA,kBAAA,OAAA,CAAA;AAAA,oBAAA,GAAA,EAAA;AAAA,mBAAA,CAAA;AACA;AACA;AAEA,aA7EA;;AA8EA,YAAA,KAAA,CAAA,GAAA,GAAA,KAAA,CAAA,MAAA,CAAA,MAAA;AACA,WAjFA;;AAkFA,UAAA,MAAA,CAAA,aAAA,CAAA,IAAA;AACA;AACA,OA3FA,CAAA;AA6FA,KAxJA;AAyJA,IAAA,QAzJA,sBAyJA;AACA,UAAA,KAAA,MAAA,CAAA,OAAA,EAAA;AACA,YAAA,OAAA,KAAA,MAAA,CAAA,OAAA,KAAA,UAAA,EAAA;AACA,eAAA,MAAA,CAAA,MAAA,CAAA,IAAA,GAAA,KAAA,kBAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,mBAAA,IAAA,CAAA,GAAA;AACA,WAFA,CAAA;AAGA,eAAA,MAAA,CAAA,OAAA,CAAA,KAAA,MAAA,EAAA,KAAA,kBAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,mBAAA,IAAA,CAAA,GAAA;AACA,WAFA,CAAA;AAGA;AACA;AACA,KApKA;AAqKA,IAAA,IArKA,kBAqKA;AACA,UAAA,MAAA,GAAA,KAAA,MAAA,CAAA,MAAA;AACA,WAAA,MAAA,GAAA,MAAA,CAAA,gBAAA;AACA,UAAA,QAAA,GAAA,MAAA,CAAA,IAAA;;AACA,UAAA,QAAA,EAAA;AACA,YAAA,kBAAA,GAAA,IAAA,CAAA,KAAA,CAAA,gBAAA,QAAA,CAAA,CAAA,CADA,CAEA;;AACA,QAAA,kBAAA,GAAA,kBAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,iBAAA;AACA,YAAA,GAAA,EAAA,IADA;AAEA,YAAA,EAAA,EAAA,iBAAA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,MAAA,KAAA,IAAA,CAFA;AAGA,YAAA,IAAA,EAAA,cAAA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,MAAA,KAAA,IAAA;AAHA,WAAA;AAKA,SANA,CAAA;AAOA,aAAA,kBAAA,GAAA,kBAAA;AACA,aAAA,IAAA,CAAA,IAAA,EAAA,oBAAA,EAAA,IAAA,CAAA,KAAA,CAAA,gBAAA,KAAA,kBAAA,CAAA,CAAA;;AACA,YAAA,KAAA,MAAA,CAAA,OAAA,EAAA;AACA,cAAA,OAAA,KAAA,MAAA,CAAA,OAAA,KAAA,UAAA,EAAA;AACA,iBAAA,QAAA,CAAA,MAAA;AACA;AACA;AACA;AACA;AA3LA,GAfA;AA4MA,EAAA,OA5MA,qBA4MA,CACA,CA7MA;AA8MA,EAAA,QAAA,EAAA,EA9MA;AAgNA,EAAA,OAhNA,qBAgNA;AACA,SAAA,MAAA,CAAA,eAAA,EAAA,UAAA,OAAA,EAAA,OAAA,EAAA;AACA;AACA,WAAA,IAAA;AACA,KAHA,EAGA;AACA,MAAA,IAAA,EAAA;AADA,KAHA;AAMA,SAAA,IAAA;AAEA;AAzNA,CAAA","sourcesContent":["<template>\n    <div class=\"mainViewContainer\">\n        <div class=\"frameContainer\">\n            <draggable\n                    @start=\"drag=true\"\n                    @end=\"draggItemFun\"\n                    v-model=\"orderableImageList\"\n                    :options=\"{animation:1000}\"\n            >\n                <transition-group tag=\"div\" class=\"frameGroupContainer\">\n                    <div :class=\"{\n                                          itemContainer:true,\n                                          showItemClass:item.id==showItemId&&showItemId!=''\n                                          }\" v-if=\"item&&seq<config.maxNum\" :style=\"{\n                                            background:'transparent'\n                                          }\"\n                         v-for=\"(item,seq) in orderableImageList\"\n                         :key=\"'item'+seq\" :groupIndex=\"seq\">\n                        <div class=\"imageContainer\" :style=\"{background:'url('+(item.url)+') no-repeat center center',height:'120px',width:'100%'}\"\n                             :groupIndex=\"seq\">\n                            <span class=\"tipLabel\" style=\"display: none\"></span>\n                        </div>\n                        <div class=\"operateContainer\" v-if=\"!config.readonly\">\n                            <span @click=\"moveItem($event,orderableImageList,0,item,seq,'d',1)\" style=\"width:20px;height:20px;border-radius: 50%;text-align: center;\"></span>\n                        </div>\n                    </div>\n                </transition-group>\n            </draggable>\n        </div>\n        <div :class=\"config.style||'addBtnContainer'\" v-if=\"orderableImageList.length<config.maxNum&&!config.readonly\" style=\"align-self:center;margin-left:0px;font-size: 14px;text-align: left;\">\n            <el-upload\n                    class=\"upload-demo\"\n                    name=\"file\"\n                    multiple\n                    :show-file-list=\"false\"\n                    action=\"/api-backend/fileUpload.json\"\n                    :on-change=\"onchangeUpload\"\n                    :before-upload=\"beforeIconUpload\"\n                    :on-success=\"saveAppSuccess\">\n                <el-button size=\"small\" type=\"primary\">批量上传图片</el-button>\n                <div slot=\"tip\" class=\"el-upload__tip\">\n                    <div v-if=\"!config.tip\">\n                        文件上传较大时，请耐心等待\n                    </div>\n                    <template v-else>\n                        <div v-html=\"config.tip\"></div>\n                    </template>\n                </div>\n            </el-upload>\n        </div>\n    </div>\n</template>\n<script>\n    import draggable from 'vuedraggable'\n\n    export default {\n        components:{\n            draggable\n        },\n        name: 'images',\n        data(){\n            return{\n                drag:false,\n                showItemId:0,\n                config:{\n                    readonly:false\n                },\n                orderableImageList:[],\n            }\n        },\n        methods:{\n            addItem(frame,seq,url){\n                console.log(frame.length)\n                if(frame.length>=this.config.maxNum){\n                    return;\n                }\n                frame.push({\n                    id:url,\n                    name:'图片',\n                    url:url||''\n                })\n                this.$set(this,\"orderableImageList\",JSON.parse(JSON.stringify(this.orderableImageList)))\n                this.syncData()\n            },\n            moveItem(event,frame,index,item,seq,direction,moveType){\n                event.preventDefault();\n                event.stopPropagation();\n                console.log(frame,index,item,seq,direction,moveType)\n                if(direction == \"v\"){\n                    let tempItem=frame.splice(seq,1)[0];\n                    frame.splice(seq+moveType,0,tempItem);\n                }else if(direction == \"h\"){\n                    let targetFram=this.orderableImageList[index+moveType];\n                    let tempItem=frame.splice(seq,1)[0];\n                    targetFram.push(tempItem);\n                }else if(direction == \"d\"){\n                    frame.splice(seq,1);\n                    if(frame.length==0&&this.orderableImageList.length>5){\n                        this.orderableImageList.splice(index,1);\n                    }\n                }\n                this.$set(this,\"orderableImageList\",JSON.parse(JSON.stringify(this.orderableImageList)))\n                this.syncData();\n            },\n            draggItemFun(param){\n                this.drag=false;\n                this.syncData();\n            },\n            mouseout(item){\n                this.showItemId=0;\n            },\n            mouseover(item){\n                this.showItemId=item.id;\n            },\n            saveAppSuccess(response, file, fileList){\n                // console.log(response,file,fileList)\n                console.log(file)\n                let url=response.data.fileUrls[0];\n                this.addItem(this.orderableImageList,0,url);\n                this.$nextTick(data=>{\n                    this.loading&&this.loading.close&&this.loading.close();\n                })\n            },\n            onchangeUpload(data){\n                this.choosedAppIcon=data;\n            },\n            beforeIconUpload(file) {\n                //console.log(\"beforeIconUpload\",file)\n                let that=this;\n                return new Promise(function (resolve,reject) {\n                    if(!(file.type==\"image/png\"||file.type==\"image/jpg\"||file.type==\"image/jpeg\"||file.type==\"image/gif\")){\n                        that.$message.error('请选择.png/jpg/jpeg图片');\n                        reject({msg:\"please choose png image\"});\n                    }\n                    if(that.choosedAppIcon!=null){\n                        var reader = new FileReader();\n                        reader.onload = function(event) {\n                            let image=new Image();\n                            image.onload=data=>{\n                                //console.log(\"*******\",data,file)\n                                let imageData=data.path&&data.path[0]||data.target;\n                                let imageWidth=imageData.width,imageHeight=imageData.height;\n                                if(that.config.imageConfig){\n                                    let imageConfig=that.config.imageConfig;\n                                    if(imageConfig.size){\n                                        if(file.size>imageConfig.size){\n                                            that.$msgbox(\"上传图片过大 请不要超过 \"+(imageConfig.size/1024/1024).toFixed(2)+\" Mb\");\n                                            reject({msg:\"上传图片过大 请不要超过 \"+imageConfig.size/1024/1024+\" Mb\"});\n                                            return;\n                                        }\n                                    }\n                                    if(imageConfig.width){\n                                        if(imageWidth!=imageConfig.width){\n                                            console.log(imageWidth,imageHeight)\n                                            that.$msgbox(\"图片宽度必须为\"+imageConfig.width+\"px\");\n                                            reject({msg:\"图片宽度必须为\"+imageConfig.width+\"px\"});\n                                            return;\n                                        }\n\n                                    }\n                                    if(imageConfig.height){\n                                        if(imageHeight!=imageConfig.height){\n                                            that.$msgbox(\"图片高度必须为\"+imageConfig.height+\"px\");\n                                            reject({msg:\"图片高度必须为\"+imageConfig.height+\"px\"});\n                                            return;\n                                        }\n                                    }\n                                    that.loading = that.$loading({\n                                        lock: true,\n                                        text: 'Loading',\n                                        spinner: 'el-icon-loading',\n                                        background: 'rgba(0, 0, 0, 0.3)'\n                                    });\n                                    resolve({msg:\"success\"})\n                                }else{\n                                    if(that.config.validatorHandler&&typeof that.config.validatorHandler == \"function\"){\n                                        let result=that.config.validatorHandler(imageWidth,imageHeight,file)\n                                        if(result instanceof Promise){\n                                            result.then(success=>{\n                                                that.loading = that.$loading({\n                                                    lock: true,\n                                                    text: 'Loading',\n                                                    spinner: 'el-icon-loading',\n                                                    background: 'rgba(0, 0, 0, 0.3)'\n                                                });\n                                                resolve({msg:\"success\"})\n                                            },error=>{\n                                                that.$msgbox(error.msg);\n                                                reject({msg:error.msg});\n                                            })\n                                        }else{\n                                            if(result){\n                                                that.$msgbox(result.msg);\n                                                reject({msg:result.msg});\n                                            }else{\n                                                that.loading = that.$loading({\n                                                    lock: true,\n                                                    text: 'Loading',\n                                                    spinner: 'el-icon-loading',\n                                                    background: 'rgba(0, 0, 0, 0.3)'\n                                                });\n                                                resolve({msg:\"success\"})\n                                            }\n                                        }\n                                    }else{\n                                        that.loading = that.$loading({\n                                            lock: true,\n                                            text: 'Loading',\n                                            spinner: 'el-icon-loading',\n                                            background: 'rgba(0, 0, 0, 0.3)'\n                                        });\n                                        resolve({msg:\"success\"})\n                                    }\n                                }\n\n                            }\n                            image.src = event.target.result;\n                        }\n                        reader.readAsDataURL(file);\n                    }\n                })\n\n            },\n            syncData(){\n                if(this.config.dataBus){\n                    if(typeof this.config.dataBus ===\"function\"){\n                        this.$attrs.config.data=this.orderableImageList.map(item=>{\n                            return item.url;\n                        })\n                        this.config.dataBus(this.config,this.orderableImageList.map(item=>{\n                            return item.url;\n                        }));\n                    }\n                }\n            },\n            init(){\n                let config=this.$attrs.config;\n                this.config=config.imagesListConfig;\n                let formData=config.data;\n                if(formData){\n                    let orderableImageList=JSON.parse(JSON.stringify(formData));\n                    //console.log(\"orderableI--------mageList\",orderableImageList)\n                    orderableImageList=orderableImageList.map(item=>{\n                        return {\n                            url:item,\n                            id:'file_Id_temp'+Math.ceil(Math.random()*1000),\n                            name:'file_temp'+Math.ceil(Math.random()*1000)\n                        }\n                    })\n                    this.orderableImageList=orderableImageList;\n                    this.$set(this,\"orderableImageList\",JSON.parse(JSON.stringify(this.orderableImageList)))\n                    if(this.config.dataBus){\n                        if(typeof this.config.dataBus ===\"function\"){\n                            this.syncData(\"init\")\n                        }\n                    }\n                }\n            }\n        },\n        created() {\n        },\n        computed:{\n        },\n        mounted(){\n            this.$watch(\"$attrs.config\",function (newData,oldData) {\n                //console.log(\"newData,oldData\",newData)\n                this.init();\n            },{\n                deep:true\n            })\n            this.init();\n\n        }\n    }\n</script>\n\n<style scoped>\n    #container {\n        height: 300px;\n        width:800px;\n    }\n    .showItemClass{\n        animation: colors 3s  infinite ;\n        /*box-shadow: 1px 1px  10px #000,1px -1px  10px #000,-1px -1px  10px #000;*/\n    }\n\n    @keyframes colors {\n        0%{\n            background: #000!important;\n            transform: rotateY(0deg);\n        }\n\n        100%{\n            background: #ff0!important;\n            transform: rotateY(360deg);\n        }\n    }\n    .popContainer{\n    }\n    .frameContainer{\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: stretch;\n        background: #fff;\n        text-align: center;\n        max-width: 840px;\n        overflow-x: auto;\n\n    }\n    .frameGroupContainer{\n        border: 0px solid #aaa;\n        border-radius: 3px;\n        margin-right: 12px;\n        width: 100%;\n        padding: 0px;\n        text-align: center;\n        overflow-y: auto;\n        min-width: 165px;\n        display: flex;\n        flex-direction: row;\n        flex-wrap: wrap;\n        justify-content: flex-start;\n        align-items: flex-start;\n    }\n    .frameGroupContainer > div{\n        flex-shrink: 0;\n        flex-grow: 0;\n    }\n    .itemContainer{\n        background: #fff;\n        margin-bottom: 4px;\n        min-height: 100px;\n        border: 1px solid #e8e8e8;\n        border-radius: 5px;\n        position: relative;\n        cursor: move;\n        margin-right: 4px;\n        width: 160px;\n    }\n    .frameGroupContainer .itemContainer:last-child{\n        margin-right: 0px;\n    }\n    .itemContainer img{\n        height: 120px;\n        width: auto;\n    }\n    .nameContainer{\n        font-size: 12px;\n        margin-top: 10px;\n        margin-bottom: 10px;\n    }\n\n    .titleLabel{\n        margin-top: 10px;\n        margin-bottom: 10px;\n        cursor: move;\n    }\n    .addBtnContainer{\n        cursor: pointer;\n        background: #eee;\n        border-radius: 4px;\n        padding: 7px 17px;\n        color: #fff;\n        width: 60%;\n    }\n    .operateContainer{\n        position: absolute;\n        top:0px;\n        right: 0px;\n        display: none;\n    }\n\n    .operateContainer span{\n        background: url(\"http://ejiaziimg.goodaa.com.cn/pic_eaddbf41-852e-4fe8-a72d-0a52c360b77e.png\") no-repeat center center;\n        background-size: cover;\n        cursor: pointer;\n        margin-bottom: 0px;\n        border:1px solid #fff;\n        text-align: center;\n        color: #fff;\n        display: inline-block;\n    }\n    .noChooseTip{\n        position: absolute;\n        top: 0px;\n        right: 0px;\n        width: 100%;\n        background: rgba(0, 0, 0, 0.57);\n        display: flex;\n        height: 100%;\n        flex-direction: row;\n        justify-content: center;\n        align-items: center;\n        color: #ffffff;\n    }\n    .changeTip{\n        position: absolute;\n        top: 0px;\n        right: 0px;\n        width: 100%;\n        background: rgba(0, 0, 0, 0.57);\n        display: none;\n        height: 100%;\n        flex-direction: row;\n        justify-content: center;\n        align-items: center;\n        color: #ffffff;\n    }\n    .itemContainer:hover .changeTip{\n        display: flex;\n    }\n    .itemContainer:hover .operateContainer{\n        width: 100%;\n        height: 100%;\n        padding-top: -10px;\n        padding-right: -10px;\n        display: block;\n        text-align: right;\n    }\n    .btnsContainer{\n        margin-top: 80px;\n        margin-top: 40px;\n    }\n    .imageContainer{\n        -webkit-background-size: contain!important;\n        background-size: contain!important;\n        position: relative;\n        overflow: hidden;\n        width: 160px!important;\n        height: 100px!important;\n    }\n    .titleContainer{\n        background: #f0f0f0;\n        display: none!important;\n        padding: 10px;\n        display: flex;\n        flex-direction: row;\n        justify-content: flex-start;\n        align-items: center;\n    }\n    .titleContainer div:first-child{\n        margin-bottom: 10px;\n    }\n\n\n    /*定义滚动条高宽及背景 高宽分别对应横竖滚动条的尺寸*/\n    ::-webkit-scrollbar\n    {\n        width: 4px;\n        height: 4px;\n        background-color: #F5F5F5;\n    }\n\n    /*定义滚动条轨道 内阴影+圆角*/\n    ::-webkit-scrollbar-track\n    {\n        -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\n        border-radius: 10px;\n        background-color: #fff;\n    }\n\n    /*定义滑块 内阴影+圆角*/\n    ::-webkit-scrollbar-thumb\n    {\n        border-radius: 10px;\n        -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);\n        background-color: #666;\n    }\n\n    .tipLabel{\n        position: absolute;\n        display: inline-block;\n        background: rgba(23, 106, 249, 0.65);\n        color: rgb(255, 255, 255);\n        font-size: 12px;\n        padding: 1px 8px;\n        border-radius: 0px;\n        transform: rotateZ(-45deg);\n        left: -19px;\n        width: 70px;\n        top: 14px;\n        line-height: 20px;\n    }\n\n    .chooseItemContainer{\n        background: #fff;\n        padding: 5px;\n        padding-top: 5px;\n        margin-bottom: 15px;\n    }\n\n    .chooseItemContainer > div{\n        display: inline-block;\n        padding: 5px 10px;\n        font-size: 14px;\n        border-radius: 3px;\n        border:1px solid #0056aa;\n        text-align: center;\n        cursor: pointer;\n        color:#0056aa ;\n        background: #fff;\n    }\n\n    .advertTypeChoosed{\n        background: #0051fb99!important;\n        color: #fff!important;\n        border: 1px solid #fff!important;\n    }\n\n    .switchContainer{\n        display: inline-block;\n        padding: 0px;\n    }\n\n    .switchContainer >div{\n        padding: 5px 10px;\n        border: 1px dashed #ccc;\n        border-radius: 5px;\n        color: #000;\n        cursor: pointer;\n    }\n\n    .appInfoContainer{\n        display: inline-block;\n        width: 200px;\n        color: #000;\n        font-size: 12px;\n    }\n    .appInfoContainer span{\n        display: block;\n    }\n\n    .chooseAppBtn{\n        width: 130px;\n        text-align: center;\n        margin-right: 30px;\n        color: #fff;display: inline-block;background: #3b97d7;border:1px solid #fff;border-radius: 5px;font-size: 14px;padding: 5px 10px;cursor: pointer;\n    }\n    .choosedAppItem{\n        padding: 0px;position: relative;margin-right: 10px;\n        display: flex;\n        height: 88px;\n        width: 100px;\n        flex-direction: row;\n        justify-content: center;\n        align-items: center;\n    }\n    .channelAppForbidden{\n        font-size:12px;line-height:80px;text-align:center;color: #f00;display: inline-block;position: absolute;background: rgba(0,0,0,0.5);width: 100%;height: 100%;top:0px;left:0px;color:#f00;\n    }\n    .chooseSpreadBtn{\n        width: 130px;\n        margin-right: 30px;\n        text-align: center;\n        color: #fff;display: inline-block;background: #97a8be;border:1px solid #fff;border-radius: 5px;font-size: 14px;padding: 5px 10px;cursor: pointer;\n    }\n\n    .mainViewContainer{\n        padding: 0px;\n    }\n    .mainViewContainer >div:nth-child(1){\n        flex-grow: 1;\n        flex-shrink: 1;\n    }\n    .mainViewContainer >div:nth-child(2){\n        flex-grow: 0;\n        flex-shrink: 0;\n    }\n    .chooseItem{\n        display: none;\n    }\n    .chooseItem + label{\n        background: #fff url('http://img-steward-test.goodaa.com.cn/47b8be2b6fd441eabd319abaf9677115.png') no-repeat !important;\n        background-position: 3px 1px!important;\n        background-size: 51px 23px!important;\n    }\n    .chooseItem:checked + label{\n        background: #fff url('http://img-steward-test.goodaa.com.cn/47b8be2b6fd441eabd319abaf9677115.png') no-repeat !important;\n        background-position: -27px 1px!important;\n        background-size: 52px 23px!important;\n    }\n    .checkItem{\n        display: inline-block;\n        width: 28px;\n        height: 28px;\n    }\n    .myBtn{\n        background: #333 !important;\n        text-align: center;\n        color: #fff!important;\n        cursor: pointer;\n    }\n    .myBtnChecked{\n        background: #fff !important;\n        text-align: center;\n        color: #333!important;\n        cursor: pointer;\n    }\n</style>\n<style>\n    .myBtn{\n        background: #333 !important;\n        text-align: center;\n        color: #fff!important;\n        cursor: pointer;\n    }\n\n</style>\n"],"sourceRoot":"src/components/formCreater"}]}